{{ define "main" }}
<style>
  /* container + typografi (ens med de andre sider) */
  .ro-wrap{max-width:1200px;margin:0 auto;padding:1.25rem 1.25rem 2rem}
  .ro-h1{font-size:clamp(2.2rem,4.5vw,3.4rem);line-height:1.15;margin:0 0 1rem}
  .ro-sub{font-size:clamp(1.05rem,1.7vw,1.2rem);opacity:.9;margin:.25rem 0 1.25rem}

  /* grid + kort */
  .ro-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px}
  .ro-card{position:relative;display:block;border-radius:16px;overflow:hidden;background:rgba(255,255,255,.04);box-shadow:0 6px 22px rgba(0,0,0,.18)}
  .ro-card img{display:block;width:100%;height:180px;object-fit:cover}
  .ro-card-label{
    position:absolute;left:.75rem;bottom:.6rem;
    background:rgba(0,0,0,.55);color:#fff;padding:.35rem .6rem;border-radius:8px;
    font-size:.95rem;line-height:1
  }
  .ro-card:hover{opacity:.96;transition:.2s}
  .ro-ph{height:180px;display:flex;align-items:center;justify-content:center;font-weight:600;opacity:.85}
</style>

<div class="ro-wrap">
  <h1 class="ro-h1">Works</h1>
  <p class="ro-sub">Browse by category</p>

  {{ $cats := site.Taxonomies.categories | default (dict) }}

  {{/* Pæne labels til faste kategorier (nøgler = slug) */}}
  {{ $pretty := dict
      "cool-blues"        "Cool Blues"
      "warm-pastels"      "Warm Pastels"
      "orange-reds"       "Orange & Reds"
      "sea-fjord"         "Sea & Fjord"
      "dunes-sandscapes"  "Dunes & Sandscapes"
      "curated-picks"     "Curated Picks"
      "personal"          "Personal"
  }}

  <div class="ro-grid">
    {{ range $name, $pages := $cats }}
      {{/* $name kan være label eller slug; normalisér til slug */}}
      {{ $slug := urlize $name }}
      {{ $label := index $pretty $slug | default (title (replace (replace $name "-" " ") "_" " ")) }}

      {{/* Repræsentativt billede fra første side i kategorien */}}
      {{ $first := index (sort $pages "Date" "desc") 0 }}
      {{ $img := false }}
      {{ with $first }}{{ with .Resources.GetMatch (printf "*%s" (path.Base .Params.cover.image)) }}{{ $img = . }}{{ end }}{{ end }}

      {{/* Find term-siden; fallback til ren URL */}}
      {{ $term := site.GetPage (printf "/categories/%s" $slug) }}
      {{ $href := cond $term $term.RelPermalink (printf "/categories/%s/" $slug | relURL) }}

      <a class="ro-card" href="{{ $href }}" title="{{ $label }}">
        {{ if $img }}
          {{ $thumb := $img.Fit "900x500 q80" }}
          <img src="{{ $thumb.RelPermalink }}" alt="{{ $label }}" loading="lazy" decoding="async">
        {{ else }}
          <div class="ro-ph">{{ $label }}</div>
        {{ end }}
        <span class="ro-card-label">{{ $label }}</span>
      </a>
    {{ end }}
  </div>
</div>
{{ end }}
