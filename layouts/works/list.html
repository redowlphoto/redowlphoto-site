{{ define "main" }}
<style>
  .ro-wrap{max-width:1200px;margin:0 auto;padding:2.5rem 1.25rem}
  .ro-h1{font-size:clamp(1.6rem,2.5vw,2.2rem);margin:0 0 1.25rem 0}
  .ro-sub{font-size:clamp(1.05rem,1.5vw,1.2rem);opacity:.9;margin:.25rem 0 1.25rem}
  .ro-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:16px}
  .ro-card{position:relative;display:block;border-radius:12px;overflow:hidden;background:rgba(255,255,255,.04)}
  .ro-card img{display:block;width:100%;height:200px;object-fit:cover}
  .ro-card-label{
    position:absolute;left:.75rem;bottom:.6rem;
    background:rgba(0,0,0,.55);color:#fff;padding:.25rem .5rem;border-radius:8px;
    font-size:.9rem;line-height:1
  }
  .ro-card:hover{opacity:.94;transition:.2s}
  .ro-ph{
    height:200px;display:flex;align-items:center;justify-content:center;
    font-weight:600;opacity:.8
  }
</style>

<div class="ro-wrap">
  <h1 class="ro-h1">Works</h1>

  {{/* Hent taxonomien 'categories' */}}
  {{ $cats := site.Taxonomies.categories }}

  {{ if gt (len $cats) 0 }}
    <p class="ro-sub">Browse by category</p>

    {{/* Fast ønsket rækkefølge; ukendte kategorier til sidst */}}
    {{ $order := slice
        "Cool Blues"
        "Warm Pastels"
        "Sea & Fjord"
        "Dunes & Sandscapes"
        "Curated Picks"
        "Personal"
    }}

    {{ $names := slice }}
    {{ range $order }}
      {{ if isset $cats . }} {{ $names = $names | append . }} {{ end }}
    {{ end }}
    {{ range $name, $_ := $cats }}
      {{ if not (in $names $name) }} {{ $names = $names | append $name }} {{ end }}
    {{ end }}

    <div class="ro-grid">
      {{ range $names }}
        {{ $name := . }}
        {{ $pages := index $cats $name }}

        {{/* Repræsentativt billede: første side i kategorien */}}
        {{ $first := index (sort $pages "Date" "desc") 0 }}
        {{ $img := false }}
        {{ with $first }}
          {{ with .Resources.GetMatch (printf "*%s" (path.Base .Params.cover.image)) }}{{ $img = . }}{{ end }}
        {{ end }}

        {{ $term := site.GetPage (printf "/categories/%s" (urlize $name)) }}

        {{/* Pæn label: erstat bindestreger med mellemrum og Title-case */}}
        {{ $pretty := title (replace $name "-" " ") }}

        <a class="ro-card" href="{{ $term.RelPermalink }}" title="{{ $pretty }}" aria-label="{{ $pretty }}">
          {{ if $img }}
            {{ $thumb := $img.Fit "800x450 q80" }}
            <img src="{{ $thumb.RelPermalink }}" alt="{{ $pretty }}" loading="lazy" decoding="async">
          {{ else }}
            <div class="ro-ph">{{ $pretty }}</div>
          {{ end }}
          <!-- Kun navn, intet tal -->
          <span class="ro-card-label">{{ $pretty }}</span>
        </a>
      {{ end }}
    </div>

  {{ else }}
    {{/* Fallback: vis grid af værker hvis der ingen kategorier er endnu */}}
    <div class="ro-grid">
      {{ range .Pages.ByDate.Reverse }}
        {{ $img := false }}
        {{ with .Resources.GetMatch (printf "*%s" (path.Base .Params.cover.image)) }}{{ $img = . }}{{ end }}
        {{ if $img }}
          {{ $thumb := $img.Fit "800x450 q80" }}
          <a class="ro-card" href="{{ .RelPermalink }}" title="{{ .Title }}">
            <img src="{{ $thumb.RelPermalink }}" alt="{{ .Params.cover.alt }}" loading="lazy" decoding="async">
            <span class="ro-card-label">{{ .Title }}</span>
          </a>
        {{ end }}
      {{ end }}
    </div>
  {{ end }}
</div>
{{ end }}
