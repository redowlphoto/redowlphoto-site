{{ define "main" }}
<style>
  .ro-wrap{
    max-width: var(--ro-maxw);
    margin-left: auto;
    margin-right: auto;
    padding-left: var(--ro-pad-x);
    padding-right: var(--ro-pad-x);
    padding-top: 2rem;
    padding-bottom: 4rem;
  }

  .ro-tagline{
    font-size:clamp(1.05rem,1.6vw,1.25rem);
    line-height:1.6;
    margin-bottom:1rem;
    color:inherit;
    opacity:.9;
  }

  /* HERO container med fast højde */
  .ro-hero{
    position:relative;
    border-radius:14px;
    overflow:hidden;
    height:clamp(240px,55vw,620px); /* fast ramme */
  }
  .ro-hero-link{display:block;position:relative;height:100%}

  /* Billeder ovenpå hinanden */
  .ro-hero img{
    position:absolute;
    inset:0;
    width:100%;
    height:100%;
    object-fit:cover;
    opacity:0;
    transition:opacity 900ms ease;
  }
  .ro-hero img.is-active{opacity:1}

  .ro-hero-cap{
    margin-top:.6rem;
    font-size:clamp(.95rem, 1.4vw, 1.1rem);
    line-height:1.55;
    opacity:.85;
  }
</style>

<div class="ro-wrap">
  <div class="ro-tagline">
    {{ with site.Data.home.tagline }}{{ . }}{{ else }}Minimal Nordic Seascapes{{ end }}
  </div>

  {{ $works := where .Site.RegularPages "Section" "works" }}
  {{ $featured := where $works ".Params.featured" true }}
  {{ $pick := cond (gt (len $featured) 0) (sort $featured "Date" "desc") (sort $works "Date" "desc") }}
  {{ $pick = first 5 $pick }}

  {{ $slides := slice }}
  {{ range $p := $pick }}
    {{ $img := false }}
    {{ with $p.Resources.GetMatch (printf "*%s" (path.Base $p.Params.cover.image)) }}{{ $img = . }}{{ end }}
    {{ if $img }}
      {{ $w1200 := $img.Resize "1200x q80" }}
      {{ $w1600 := $img.Resize "1600x q80" }}
      {{ $w2000 := $img.Resize "2000x q80" }}
      {{ $slides = $slides | append (dict
        "w1200" $w1200
        "w1600" $w1600
        "w2000" $w2000
        "alt"   ($p.Params.cover.alt | default $p.Title)
      ) }}
    {{ end }}
  {{ end }}

  {{ if gt (len $slides) 0 }}
    <div class="ro-hero">
      <a class="ro-hero-link" href="{{ "works" | relURL }}" aria-label="Go to Works">
        {{ range $i, $s := $slides }}
          <img class="ro-slide{{ if eq $i 0 }} is-active{{ end }}"
               src="{{ $s.w1200.RelPermalink }}"
               srcset="{{ $s.w1200.RelPermalink }} 1200w, {{ $s.w1600.RelPermalink }} 1600w, {{ $s.w2000.RelPermalink }} 2000w"
               sizes="100vw"
               alt="{{ $s.alt }}"
               {{ if eq $i 0 }}loading="eager" fetchpriority="high"{{ else }}loading="lazy"{{ end }}
               decoding="async">
        {{ end }}
      </a>
    </div>

    {{ with site.Data.home.hero_caption }}
      <p class="ro-hero-cap">{{ . }}</p>
    {{ end }}
  {{ end }}
</div>

<script>
(function(){
  var slides = document.querySelectorAll('.ro-slide');
  if(!slides.length) return;
  var i = 0;
  setInterval(function(){
    slides[i].classList.remove('is-active');
    i = (i + 1) % slides.length;
    slides[i].classList.add('is-active');
  }, 7500); // 7,5 sek
})();
</script>
{{ end }}
