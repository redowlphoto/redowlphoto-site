{{ define "main" }} 
{{ $root := . }}
<style>
  .ro-wrap {
    max-width: var(--ro-maxw);
    margin: 0 auto;
    padding: 2.5rem var(--ro-pad-x);
  }

  .ro-h1 {
    font-size: var(--ro-h1-size);
    margin: 0 0 1.25rem 0;
  }

  .ro-intro {
    max-width: 70ch;
    opacity: .9;
    margin: -.25rem 0 1.25rem;
  }

  .ro-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 1.25rem;
  }

  .ro-card {
    position: relative;
    display: block;
    border-radius: 12px;                  /* konsistent afrunding */
    overflow: hidden;
    background: rgba(255, 255, 255, .04);
  }

  .ro-card img {
    display: block;
    width: 100%;
    height: 200px;
    object-fit: cover;
    border-radius: 12px;                  /* samme afrunding som Works */
  }

  .ro-card-label {
    position: absolute;
    left: .75rem;
    bottom: .6rem;
    background: rgba(0, 0, 0, .55);
    color: #fff;
    padding: .25rem .5rem;
    border-radius: 8px;
    font-size: .9rem;
    line-height: 1;
  }

  .ro-card:hover { opacity: .94; transition: .2s; }
  .ro-empty { opacity: .75; }
</style>

<div class="ro-wrap">
  <h1 class="ro-h1">{{ $root.Title }}</h1>

  {{ with $root.Params.intro }}
    <div class="ro-intro">{{ . | markdownify }}</div>
  {{ end }}

  {{ $pages := $root.Pages }}
  {{ if or (not $pages) (eq (len $pages) 0) }}
    {{ $catmap := site.Taxonomies.categories | default (dict) }}
    {{ $key := "" }}
    {{ range $k, $_ := $catmap }}
      {{ if eq (urlize $k) (urlize $root.Title) }}
        {{ $key = $k }}
      {{ end }}
    {{ end }}
    {{ if ne $key "" }}
      {{ $pages = index $catmap $key }}
    {{ end }}
  {{ end }}

  {{ if and $pages (gt (len $pages) 0) }}
    <div class="ro-grid">
      {{ range $p := (sort $pages "Date" "desc") }}
        {{ $img := false }}
        {{ with $p.Resources.GetMatch (printf "*%s" (path.Base $p.Params.cover.image)) }}{{ $img = . }}{{ end }}
        {{ if $img }}
          {{ $thumb := $img.Fit "800x450 q80" }}
          <a class="ro-card" href="{{ $p.RelPermalink }}" title="{{ $p.Title }}">
            <img src="{{ $thumb.RelPermalink }}" alt="{{ $p.Params.cover.alt | default $p.Title }}" loading="lazy" decoding="async">
            <span class="ro-card-label">{{ $p.Title }}</span>
          </a>
        {{ end }}
      {{ end }}
    </div>
  {{ else }}
    <p class="ro-empty">Ingen v√¶rker i denne kategori endnu.</p>
  {{ end }}
</div>
{{ end }}
